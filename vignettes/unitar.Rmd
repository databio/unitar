---
title: "Getting started with unitar"
author: "Nathan Sheffield"
date: "`r Sys.Date()`"
vignette: >
  %\VignetteIndexEntry{1. Getting started with unitar}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, echo=FALSE}
# These settings make the vignette prettier
# knitr::opts_chunk$set(results="hold", collapse=FALSE, message=FALSE)
```

# Introduction

## Installing unitar

Install `unitar` like this:

```{r, eval=FALSE}
devtools::install_github("databio/unitar")
```


## Basic demo

In the [target_projects](/target_projects), we have 2 subfolders. Each of these represents a separate project that uses targets; you can find a `_targets.R` file in each subfolder. These represent your typical, independent targets project folders.

Here's how you'd load these targets in using `unitar_read`:

```{r}
library("unitar")
project_root = system.file("extdata", "target_projects", package="unitar")

project_subfolders = list.files(project_root)
project_folders = paste(project_root, project_subfolders, sep="/")

unitar::unitar_make(project_folders)

big_data_set = unitar::unitar_read(project_folders, "big_data_set")
head(big_data_set)
```

`unitar_read` works like `tar_read`, but you give it a priority list of targets folders to search, and so it can search outside your current targets environment. This way you can share built targets across projects.

`unitar_meta` works like `tar_meta`, but runs across all the given project folders:

```{r}
unitar_meta(project_folders)
```


## Using unitar with pepr

It's kind of annoying to set up and pass around a `projects_folders` variable like this, so I've simplified a connection to using a standard [PEP](http://pep.databio.org) to keep track of these things for you. To make this work, `unitar` provides a series of `peptar_*` functions that work like the `unitar_*` functions above, but operate on PEPs that you can configure with your list of project folders.

```{r}
pep_config = system.file("extdata", "metadata/project_config.yaml", package="unitar")
p = pepr::Project(pep_config)

peptar_folders(p)

peptar_path(p, "ref2")
peptar_meta(p, fields="name")
peptar_make(p)

big_data_set2 = peptar_read(p, "big_data_set")
head(big_data_set2)
```